
grasppe=eval("(function (w) {'use strict'; if (typeof w.grasppe !== 'function') w.grasppe = class grasppe{constructor(){}};}(this)); grasppe");function grasppeGoogleAPI(container,delegate,clientID,scriptID,scopes){if(!(this instanceof grasppeGoogleAPI)&&gapi){if(grasppeGoogleAPI.inited)return;grasppeGoogleAPI.inited=true;gapi.auth.init();$(window).trigger('init.grasppe.GoogleAPI');return grasppe.GoogleAPI;}
var prototype=Object.getPrototypeOf(this);Object.assign(this,{clientID:clientID||prototype.clientID,scriptID:scriptID||prototype.scriptID,scopes:scopes||prototype.scopes,delegate:delegate,container:container||prototype.container,});this.authorized=(this.getParameterArray().equals([prototype.clientID,prototype.scriptID,prototype.scopes]))?prototype.authorized:false;$(window).on('init.grasppe.GoogleAPI',function(event){this.authorize(true);var delegate=(event.type in this.delegate)?this.delegate[event.type]:this.delegate;if(typeof delegate==='function')delegate.apply(this,arguments);}.bind(this)).on('unauthorized.grasppe.GoogleAPI',function(event,source){source=source||{};var delegate=(event.type in source.delegate)?source.delegate[event.type]:source.delegate;if(typeof delegate==='function')delegate.apply(source,arguments);}.bind(this)).on('authorized.grasppe.GoogleAPI',function(event,source){source=source||{};var delegate=(event.type in source.delegate)?source.delegate[event.type]:source.delegate;if(typeof delegate==='function')delegate.apply(source,arguments);}.bind(this));$(function(){if(this.authorized!==true)setTimeout(this.showTarget.bind(this),1000);}.bind(this));};grasppe.GoogleAPI=grasppeGoogleAPI;grasppe.GoogleAPI.prototype={clientID:'577355195882-ntebiap3df729vokfuqa0ojto8tf91so.apps.googleusercontent.com',scriptID:'MjLeGCPlfsxep9y8Ja_Ki03CSI4gMe0_o',scopes:['https://www.googleapis.com/auth/script.storage','https://www.googleapis.com/auth/spreadsheets'],authorized:false,result:undefined,targer:undefined,button:undefined,container:document.body,getParameterArray:function(){return[this.clientID,this.scriptID,this.scopes];},getContainer:function(){if(!(this.container instanceof HTMLElement))this.container=$(this.container)[0];return $(this.container);},setAuthorized:function(authorized){var prototype=Object.getPrototypeOf(this);authorized=(typeof authorized==='object'&&!authorized.error)||arguments.length===0||authorized===true||this.authorized===true;if(typeof authorized==='object')this.result=authorized;if(this.getParameterArray().equals([prototype.clientID,prototype.scriptID,prototype.scopes]))prototype.authorized=authorized;var triggerEvent=this.authorized!==authorized&&authorized===true;this.authorized=authorized;this.getButton().text(this.authorized===true?'Authorized':'Authorize');$(this.target).css('display',this.authorized===true?'none':'inline');if(triggerEvent)$(window).trigger('authorized.grasppe.GoogleAPI',[this]);},authorize:function(immediate){this.getButton().text('Authorizing...');var instance=this,authorized=gapi.auth.authorize({'client_id':instance.clientID,'scope':instance.scopes.join(' '),'immediate':true},this.setAuthorized.bind(instance));this.milliseconds=3000+new Date().getTime();while(new Date()<this.milliseconds&&instance.authorized!==true&&immediate!==true){}
if(instance.authorized!==true&&immediate!==true)return gapi.auth.authorize({'client_id':instance.clientID,'scope':instance.scopes.join(' '),'immediate':false},this.setAuthorized.bind(instance));this.getButton().text('Authorize');},run:function(method,parameters,callback){if(!this.authorized)throw('Unauthorized!');try{if(typeof callback==='function')return gapi.client.request(this.getRequest(method,parameters)).then(callback.bind(this));else{}}catch(err){console.log(method,parameters,err,this.getParameterArray());}},getRequest:function(method,parameters){var body={'function':method,'devMode':false};if(parameters)body.parameters=parameters;var scriptID=this.scriptID;var request={'root':'https://script.googleapis.com','path':'v1/scripts/'+scriptID+':run','method':'POST','body':body};return request;},getTarget:function(container){var instance=this;this.container=container||this.container||document.body;if(!(this.target instanceof HTMLElement))this.target=$('<div>').css('display','none').append($('<a class="btn btn-xs btn-danger btn-authorize">Authorize</a>').on('click',function(){instance.authorize();}.bind(instance))).appendTo(this.getContainer())[0];return $(this.target);},getButton:function(){return this.getTarget().find('.btn-authorize').first();},showTarget:function(){if(this.authorized!==true)$(this.getTarget()).css('display','inline').popover({viewport:"body",container:"body",content:'You must authorize access to Google Apps Script Execution API',placement:'left',trigger:'hover'});window.setTimeout(function(instance,target){if(instance.authorized!==true)$(target).popover('show');},5000,this,this.getTarget());},}
function grasppeAuthorizeGoogleAPI(){}
var CLIENT_ID='577355195882-ntebiap3df729vokfuqa0ojto8tf91so.apps.googleusercontent.com',SCRIPT_ID='MjLeGCPlfsxep9y8Ja_Ki03CSI4gMe0_o',SCOPES=['https://www.googleapis.com/auth/script.storage','https://www.googleapis.com/auth/spreadsheets'];